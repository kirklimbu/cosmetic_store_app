<nz-card class="product-detail-card" nzBordered>
    <div class="pd-grid">
        <!-- LEFT: IMAGE SECTION -->
        <div class="pd-image-col" role="region" aria-label="Product images">
            <div class="main-image">
                <img nz-image [nzSrc]="product().path" nzWidth="100%" nzHeight="100%" nzPreview alt="product().name" />

                <ng-template #placeholderTpl>
                    <div class="image-placeholder" aria-hidden="true">
                        Image not available
                    </div>
                </ng-template>
            </div>

            <!-- <div class="thumbs" *ngIf="images().length > 1">
                <button type="button" class="thumb" *ngFor="let img of images(); let i = index"
                    [class.active]="i === selectedImageIndex()" (click)="onSelectImage(i)"
                    aria-label="Select image {{ i + 1 }}">
                    <img [src]="img" [alt]="product()?.name + ' thumbnail ' + (i + 1)" />
                </button>
            </div> -->
        </div>

        <!-- RIGHT: INFO SECTION -->
        <div class="pd-info-col" role="region" aria-label="Product information">
            <div class="meta">
                <div class="crumbs">
                    <a class="category" routerLink="/category/{{ product()?.categoryId }}">{{ product()?.category }}</a>
                    <span class="dot">•</span>
                    <a class="brand" routerLink="/brand/{{ product()?.companyId }}">{{ product()?.company }}</a>
                </div>

                <h1 class="title">{{ product()?.name }}</h1>

                <div class="price-stack">
                    <div class="price-now">Rs. {{ formattedPrice(product()?.pricePerUnit ?? 0) }}</div>
                    <div class="mrp" *ngIf="product()?.mrp && product()?.mrp > product()?.pricePerUnit">
                        <span class="mrp-label">MRP</span>
                        <span class="mrp-value">Rs. {{ formattedPrice(product()?.mrp ?? 0) }}</span>
                    </div>
                    <div class="saving" *ngIf="saving() > 0">
                        You save: Rs. {{ formattedPrice(saving()) }}
                    </div>

                    <div class="stock-badge">
                        <nz-badge *ngIf="!isOutOfStock()" nzStatus="processing"
                            [nzText]="product()?.remaining + ' in stock'"></nz-badge>
                        <nz-badge *ngIf="isOutOfStock()" nzStatus="error" nzText="Out of stock"></nz-badge>
                    </div>
                </div>

                <div class="actions">
                    <nz-input-number [ngModel]="qty()" min="1" max="product()?.remaining || 9999"
                        (ngModelChange)="onQtyChange($event)" aria-label="Quantity"></nz-input-number>

                    <button class="add-to-cart-btn " nz-button nzType="primary" [disabled]="isOutOfStock()" (click)="addToCart()">
                        Add to cart
                    </button>

                    <!-- <button nz-button nzType="default" class="buy-now" [disabled]="isOutOfStock()">
                        Buy now
                    </button> -->
                </div>

                <div class="shipping-note" *ngIf="!isOutOfStock()">
                    <small>Free delivery within Damak for orders above Rs. 1000 • COD available</small>
                </div>

                <div class="product-meta">
                    <div><strong>Unit:</strong> {{ product()?.unit }}</div>
                    <div *ngIf="product()?.minNotification">Min notify: {{ product()?.minNotification }}</div>
                </div>
            </div>
        </div>
    </div>
</nz-card>